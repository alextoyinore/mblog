<!DOCTYPE html>
<html lang="en" class="dark:bg-gray-900">
<head>
    <%- include('../layouts/head', { title: 'Now Playing' }) %>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="font-nyt-sans w-full h-full">
    <%- include('../widgets/topnav') %>

    <main class="container mx-auto w-full mt-8 pb-20">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Left Column - Song Artwork and Details -->
            <div class="flex flex-col items-center lg:w-1/3">
                <img src="<%= song.artwork.url %>" alt="Now Playing" class="w-full h-auto rounded-lg shadow-lg" />
                <div class="mt-4 text-center">
                    <h2 class="text-3xl font-bold dark:text-white"><%= song.songTitle %></h2>
                    <p class="text-lg text-gray-600 dark:text-gray-400"><%= song.artistName %></p>
                    <p class="text-sm text-gray-500 dark:text-gray-300"><%= song.albumTitle %> â€¢ <%= song.releaseYear %></p>
                </div>
            </div>

            <!-- Right Column - Playback Controls -->
            <div class="lg:w-2/3 flex flex-col items-center">
                <div class="flex items-center justify-center space-x-4 mt-4">
                    <button id="prevButton" class="bg-transparent dark:text-white hover:text-gray-400 transition duration-200">
                        <!-- Previous Icon -->
                        <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 18l-6-6 6-6" />
                        </svg>
                    </button>
                    <button id="playButton" class="bg-transparent dark:text-white hover:text-gray-400 transition duration-200">
                        <!-- Play Icon -->
                        <svg class="h-10 w-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </button>
                    <button id="nextButton" class="bg-transparent dark:text-white hover:text-gray-400 transition duration-200">
                        <!-- Next Icon -->
                        <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6" />
                        </svg>
                    </button>
                </div>

                <!-- Seeker -->
                <div class="flex items-center mt-4">
                    <input type="range" id="seeker" class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer" value="0" min="0" max="100" />
                    <span id="currentTime" class="ml-2">0:00</span> / <span id="duration" class="ml-2">0:00</span>
                </div>

                <!-- Volume Control -->
                <div class="flex items-center mt-4">
                    <svg class="h-5 w-5 dark:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l-6 6V6l6 6h6a6 6 0 100-12H9z" />
                    </svg>
                    <input type="range" id="volumeControl" class="w-24 h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer mx-2" value="100" min="0" max="100" />
                    <svg class="h-5 w-5 dark:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12h4m-2-2v4m-4-4l-4 4m4-4l-4-4" />
                    </svg>
                </div>
            </div>
        </div>

        <!-- Related Songs Section -->
        <section class="mt-8">
            <h3 class="text-lg font-bold dark:text-white">Related Songs</h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">
                <% relatedSongs.forEach(relatedSong => { %>
                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow hover:shadow-lg transition-shadow">
                    <img src="<%= relatedSong.artwork.url %>" alt="<%= relatedSong.songTitle %>" class="w-full h-32 object-cover rounded" />
                    <h4 class="mt-2 text-md font-semibold dark:text-white"><%= relatedSong.songTitle %></h4>
                    <p class="text-sm text-gray-600 dark:text-gray-400"><%= relatedSong.artistName %></p>
                </div>
                <% }) %>
            </div>
        </section>

        <!-- Comments Section -->
        <section class="mt-8">
            <h3 class="text-lg font-bold dark:text-white">Comments</h3>
            <div class="mt-4">
                <textarea class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded" placeholder="Leave a comment..."></textarea>
                <button class="mt-2 bg-blue-500 text-white px-4 py-2 rounded">Submit</button>
            </div>
        </section>
    </main>

    <!-- Floating Play Bar - Fixed Position -->
    <div class="backdrop-blur-sm fixed bottom-0 left-0 right-0 w-full bg-white dark:bg-gray-900 border-t dark:border-gray-700 z-50">
        <div class="container mx-auto px-5 h-16">
            <div class="flex items-center justify-between dark:text-gray-500 h-full text-xs">
                <!-- Now Playing - Left Side -->
                <div class="flex items-center min-w-0">
                    <img src="https://images.unsplash.com/photo-1741192223245-46cbbe8ae332" alt="Now Playing" class="w-12 h-12 object-cover rounded" />
                    <div class="ml-3 min-w-0">
                        <h3 class="text-sm font-medium dark:text-white truncate">Currently Playing Track</h3>
                        <p class="text-xs text-gray-500 dark:text-gray-400 truncate">Artist Name</p>
                    </div>
                </div>

                <!-- Controls - Right Side -->
                <div class="playbar flex min-w-0 items-center justify-center space-x-4 p-4 text-gray-600">
                    <button id="prevButton" class="bg-transparent dark:text-white hover:text-gray-400 transition duration-200">
                        <!-- Previous Icon -->
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 18l-6-6 6-6" />
                        </svg>
                    </button>
                    <button id="playButton" class="bg-transparent dark:text-white hover:text-gray-400 transition duration-200">
                        <!-- Play Icon (Larger) -->
                        <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </button>
                    <button id="nextButton" class="bg-transparent dark:text-white hover:text-gray-400 transition duration-200">
                        <!-- Next Icon -->
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6" />
                        </svg>
                    </button>
                    
                    <div class="flex items-center">
                        <input type="range" id="seeker" class="w-64 h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer" value="0" min="0" max="100" />
                        <span id="currentTime" class="ml-2">0:00</span> / <span id="duration" class="ml-2">0:00</span>
                    </div>
                </div>

                <div class="flex min-w-0 items-center justify-between gap-5">
                    <div class="flex min-w-[60px] items-center justify-between">
                        <button id="likeButton" class="bg-transparent dark:text-white hover:text-gray-400 transition duration-200">
                            <!-- Like Icon -->
                            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                        </button>
                        <button id="shareButton" class="bg-transparent dark:text-white hover:text-gray-400 transition duration-200">
                            <!-- Share Icon -->
                            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12h4m-2-2v4m-4-4l-4 4m4-4l-4-4" />
                            </svg>
                        </button>
                        <button id="addToPlaylistButton" class="bg-transparent dark:text-white hover:text-gray-400 transition duration-200">
                            <!-- Add to Playlist Icon -->
                            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h18v18H3V3z" />
                            </svg>
                        </button>
                    </div>
                    
                    <!-- Volume Control -->
                    <div class="flex items-center">
                        <svg class="h-5 w-5 dark:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l-6 6V6l6 6h6a6 6 0 100-12H9z" />
                        </svg>
                        <input type="range" id="volumeControl" class="w-24 h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer mx-2" value="100" min="0" max="100" />
                        <svg class="h-5 w-5 dark:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12h4m-2-2v4m-4-4l-4 4m4-4l-4-4" />
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // JavaScript functionality remains the same
        const audio = new Audio('path/to/your/audio/file.mp3'); // Replace with your audio file path
        const playButton = document.getElementById('playButton');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const seeker = document.getElementById('seeker');
        const currentTimeDisplay = document.getElementById('currentTime');
        const durationDisplay = document.getElementById('duration');
        const volumeControl = document.getElementById('volumeControl');

        playButton.addEventListener('click', () => {
            if (audio.paused) {
                audio.play();
                playButton.innerHTML = '<svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';
            } else {
                audio.pause();
                playButton.innerHTML = '<svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>';
            }
        });

        audio.addEventListener('loadedmetadata', () => {
            durationDisplay.textContent = formatTime(audio.duration);
            seeker.max = audio.duration;
        });

        audio.addEventListener('timeupdate', () => {
            currentTimeDisplay.textContent = formatTime(audio.currentTime);
            seeker.value = audio.currentTime;
        });

        seeker.addEventListener('input', () => {
            audio.currentTime = seeker.value;
        });

        volumeControl.addEventListener('input', () => {
            audio.volume = volumeControl.value / 100;
        });

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
        }
    </script>

    <style>
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; /* Remove default styling */
            appearance: none;
            width: 15px; /* Thumb width */
            height: 15px; /* Thumb height */
            background: #f56565; /* Red-500 color */
            border-radius: 50%; /* Round thumb */
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 15px; /* Thumb width */
            height: 15px; /* Thumb height */
            background: #f56565; /* Red-500 color */
            border-radius: 50%; /* Round thumb */
            cursor: pointer;
        }

        input[type="range"]::-ms-thumb {
            width: 15px; /* Thumb width */
            height: 15px; /* Thumb height */
            background: #f56565; /* Red-500 color */
            border-radius: 50%; /* Round thumb */
            cursor: pointer;
        }
    </style>
</body>
</html>
